// room script file


function hHotspot1_Interact()
{
  cEgo.Walk(74, 125, eBlock);
  PlaySound(1);
  player.ChangeRoom(7, 103, 197);
  cEgo.LockViewFrame(NORMAL_CHUZE, 0, 0);
}

function room_Load()
{
  aMusic2.Stop();

  // nastaveni objektu a jejich obchazeni
  skrinka_dvirka.Solid = true;
  skrinka_dvirka2.Solid = true;
  skrinka_otevrena.Solid = true;
  skrinka_dvirka.BlockingWidth = 50;
  skrinka_dvirka.BlockingHeight = 20;
  skrinka_otevrena.BlockingWidth = 20;
  skrinka_otevrena.BlockingHeight = 20;


  if (JeNoc()) {
    cDeda.ChangeView(DEDA_LEZI);
    aSnoring_right.Play(eAudioPriorityNormal, eRepeat);
    cDeda.x=282;
    cDeda.y=181;
    dedy_boty.Visible = true;
    dedy_boty.Solid = true;

    zidle.Visible = true;
    zidle.Solid = true;

    // pochoden efekt?
    if (cEgo.HasInventory(iPochoden)) SetPochoden(true);

  } else {
    aMusic6.Play();
    cDeda.ChangeView(DEDA_SEDI);
    cDeda.x=190;
    cDeda.y=180;
    dedy_boty.Visible = false;
    zidle.Visible = false;
    
  }
 
}

function hHotspot1_Look()
{
  Displayc("Dveøe, co vedou ven pøed baráèek.");
}

function hHotspot1_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot1_UseInv()
{
  Displayc("Staèí vzít za kliku.");
}

function dedaSkrinkaKontrola()
{
  if (skrinka_dvirka.Visible) {
      dDedaSkrinkaZlobi.Start();
      udedy_skrinka_faze = 100; // faze, kdy uz neni mozne jit do chalupy a hra konci...
      player.ChangeRoom(7, 103, 197);     
  }
}

function room_AfterFadeIn()
{
  if (zobrazCerta==1)  PlayAmbientSound(1, 7, 100, 160, 0);
  
  if (questCertFaze==1) {
      dDedaCert1.Start();
  }
  
  
  if (!JeNoc()) {
    // pokud je den a skrinka je otevrena - deda to zjistil!
    dedaSkrinkaKontrola();
    
    skrinka_dvirka.Visible = false;
    skrinka_dvirka2.Visible = false;
    skrinka_otevrena.Visible = false;
  }
}

function room_RepExec()
{
  oKoste.Visible= zobrazKoste;
  if (zobrazCerta==1)
    {
        if (Random(150)==50) PlaySound(10);
        if (Random(150)==51) PlaySound(11);
    }
}

function oObject0_Interact()
{
  ShowDialog2(2, "Co si pøeješ s kostìtem udìlat?","Zamést","Vzít koštì");
}

function oKoste_Look()
{
  Displayc("Koštì na zametání a vymetání...");
}

function oKoste_Talk()
{
  Display(nicNemluvi());
}

function oKoste_UseInv()
{
  Display(nicNejdePouzit());
}

function hHotspot0_UseInv()
{
}

function hHotspot2_Interact()
{
    //Displayc("Tam budou nejspíš dìdovy osobní vìci, nemáš zapotøebí ho o nì okrádat.");
  if (JeNoc()) {
    cEgo.Walk(57, 150, eBlock, eWalkableAreas);
    // otevre skrinku
    player.FaceObject(skrinka_dvirka);
    PlaySound(1);
    skrinka_dvirka.Visible = true;
    skrinka_dvirka2.Visible = true;
    skrinka_otevrena.Visible = true;
    aSnore_right.Play();
    Wait(50);
    player.FaceCharacter(cDeda);
  } else {
    Displayc("Není zcela vhodné, abys prohledával dìdovu skøíòku, když se dìda kouká!");
  }
}

function hHotspot2_Look()
{
  Displayc("Skøínka nejspíš obsahuje dìdovy osobní vìci a cennosti, které není dobré nechat válet po místosti, aby se neøeklo, že je tu bordel, nebo aby hned nezmizely?");
}

function hHotspot2_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot2_UseInv()
{
  Displayc(nicNejdePouzit());
}

function hHotspot3_Interact()
{
  player.Walk(108, 121, eBlock);
  Displayc("Kdepak, žádný tajný sejf.");
}

function hHotspot3_Look()
{
  Displayc("Ah, až se zastavuje dech. Obraz dìdy a jeho nebožky ženy tesnì po svatbì. Tedy øeknu vám, byl to skuteènì fešák!");
}

function hHotspot3_Talk()
{
  Displayc("Pokud chceš mluvit s dìdou, promluv s jeho skuteènou podobou!");
}

function hHotspot3_UseInv()
{
  Displayc(nicNejdePouzit());
}

function hHotspot4_Interact()
{
  Displayc("Pokud by byl karneval, možná bys pøemýšlel o tom, vzít si to na hlavu, ale jinak bych to nechal radši na stìnì.");
}

function hHotspot4_Look()
{
  Displayc("Tato trofej zde visí již notnou dávku let, kdy se ještì dìda prohánìl po lese jak laò. Bohužel tahle laò se prohánìla pomaleji než dìda...");
  Displayc("Nebo že by to byl jelen?");
}

function hHotspot4_Talk()
{
  Displayc("Vzhledem k tomu, že tohle zvíøe už pár let nežije, už ani nemluví. Mezi námi, nejspíš by nemluvilo ani pøedtim.");
}

function hHotspot4_UseInv()
{
  Displayc(nicNejdePouzit());
}

function hHotspot5_Interact()
{
  Displayc("Ve skøíni je dìdovo obleèení. Vzhledem k tomu, že nic z jeho šatníku nepotøebuješ, nemáš potøebu se tam ani moc hrabat. Navíc je to neslušné.");
}

function hHotspot5_Look()
{
  Displayc("Ve skøíni je s nejvìtší pravdìpodobností dìdovo obleèení.");
}

function hHotspot5_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot5_UseInv()
{
  Displayc(nicNejdePouzit());
}

function hHotspot6_Interact()
{
  Displayc("V tom haraburdí se hrabat nebudu. Není to moje.");
}

function hHotspot6_Look()
{
  Displayc("Na skøíni je zmì nìjakého nepodstatného haraburdí.");
}

function hHotspot6_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot6_UseInv()
{
  Displayc(nicNejdePouzit());
}

function hHotspot7_Interact()
{
  Displayc("To je nìjaký rejè nebo co. To nepotøebujem.");
}

function hHotspot7_Look()
{
  Displayc("To je nìjaký rejè nebo co. To nepotøebujem.");
}

function hHotspot7_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot7_UseInv()
{
  Displayc(nicNejdePouzit());
}

function hHotspot8_Interact()
{
  if (JeNoc()) {
    ShowDialog2(3, "Chceš se trochu prospat na peci?","Šup na pec","Být vzhùru");
  } else {
    Displayc("Krásnì høeje. Prospíš se na ní, ale až bude noc. Teï bys byl jak línej Honza z pohádky.");
  }
}

function hHotspot8_Look()
{
  Displayc("Pec dodává místnosti krásnou teplou atmosféru. Navíc slouží jako tvé úložištì ke spánku. Není nad spánek na høejivé peci.");
}

function hHotspot8_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot8_UseInv()
{
  if (cEgo.ActiveInventory == iPolinko) {
    player.Walk(272, 141, eBlock);
    ShowDialog2(1, "Co chceš s polínkem udìlat?","Pøiložit","Zapálit");
  } else if (cEgo.ActiveInventory == iPochoden) {
    aKrb_polinko.Play();
    Displayc("Vložil jsi hoøící pochodeò do kamen.");
    cEgo.LoseInventory(iPochoden);
    SetPochoden(false);
  } else {
    Displayc("Tohle bych nepálil.");
  }
}

function hHotspot9_Interact()
{
    if (player.HasInventory(iPolinko))
      {
        Displayc("Vždy už jedno máš.");
      } else if (player.HasInventory(iPochoden)) {
        Displayc("Vzhledem k tomu, že máš hoøící pochodeò, není rozumné brát další døevo, nerad bys rozpoutal celosvìtový požár.");
      } else {
        player.Walk(226, 145, eBlock);
        player.AddInventory(iPolinko);    
        cEgo.ActiveInventory = iPolinko;
        Displayc("Sebral jsi polínko.");
      }
}

function hHotspot9_Look()
{
  Displayc("Košík se døevem urèeným primárnì do kamen.");
}

function hHotspot9_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot9_UseInv()
{
  if (cEgo.ActiveInventory == iPolinko) {
    player.Walk(226, 145, eBlock);
    Displayc("Vrátil jsi polínko zpìt do košíku.");
    player.LoseInventory(iPolinko);
  } else {
  Displayc(nicNejdePouzit());
  }
}

function hHotspot10_Interact()
{
  Displayc("Myslím, že dìda nestojí o naèechrání peøiny, i když by to tøeba bylo jakýmsi projevem úcty, ale radši ne.");
}

function hHotspot10_Look()
{
  if (cDeda.View == DEDA_LEZI) {
    Displayc("Dìda si hezky chrupká pod peøinou.");
  } else
  Displayc("Dìdova postel, peøina z pravého peøí je poøádnì nadýchaná. To je pelech sakryš. Dìda si tam chodí každý veèer prospat.");
}

function hHotspot10_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot10_UseInv()
{
  Displayc("Na jednu stranu by to bylo urèitì super pøekvapení, až by dìda pod peøinou objevil tohle, ale radši si to nech.");
}

function hHotspot11_Interact()
{
  Displayc("Kdepak, kdepak, žádné posedávání, hrdino, vstávat a hurá za dobrodružstvím!");
}

function hHotspot11_Look()
{
  Displayc("Lavice pro zákazníky nebo babky koøenáøky, když pøijdou na pokec k dìdovi.");
}

function hHotspot11_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot11_UseInv()
{
  Displayc(nicNejdePouzit());
}

function hHotspot12_Interact()
{
  Displayc("To jsou dìdovy pantofle. Nech mu je. I když je pravda, že by si jako správnej švec umìl obratem ruky ušít nové, ale pøeci jen, ruku na srdce, co bys s nimi dìlal? Na sezení v pantoflích u houpacího køesla máš ještì dost èasu.");
}

function hHotspot12_Look()
{
  Displayc("Pod lavicí jsou dìdovy pantofle.");
}

function hHotspot12_Talk()
{
  Displayc(nicNemluvi());
}

function hHotspot12_UseInv()
{
  Displayc("To bych do boty nestrkal.");
}

function zidle_Interact()
{
  Displayc("To je dìdovo místo.");
}

function zidle_Look()
{
  Displayc("Židle.");
}

function zidle_Talk()
{
  Displayc(nicNemluvi());
}

function zidle_UseInv()
{
  Displayc(nicNejdePouzit());
}

function dedy_boty_Interact()
{
  Displayc("To jsou dìdovy boty, na co by ti byly?");
}

function dedy_boty_Talk()
{
  Displayc(nicNemluvi());
}

function dedy_boty_UseInv()
{
  Displayc(nicNejdePouzit());
}

function dedy_boty_Look()
{
  Displayc("Dìdovy boty.");
}


function hHotspot13_Look()
{
  Displayc("Nacházíš se v útulné chaloupce dìdy - tvého zachránce. Uprostøed je velký stùl, kde dìda rád sedí. Pak je tu taky postel s duchnou velkou jak mrak a velká pec.");
}

function skrinka_dvirka_Interact()
{
  // zavre skrinku
  cEgo.Walk(57, 150, eBlock, eWalkableAreas);
  player.FaceObject(skrinka_dvirka);
  PlaySound(1);
  skrinka_dvirka.Visible = false;
  skrinka_dvirka2.Visible = false;
  skrinka_otevrena.Visible = false;
  aSnore_right.Play();
  Wait(50);
  player.FaceCharacter(cDeda);
}

function skrinka_dvirka_Look()
{
  Displayc("Chceš zavøít skøínku?");
}

function skrinka_otevrena_Look()
{
  cEgo.Walk(57, 150, eBlock, eWalkableAreas);
  if (udedy_skrinka_faze>=2) {
    Displayc("Ve skøínce už není nic, co by sis mohl pøivlastnit!");
    return;
  }  
  if (udedy_skrinka_faze==1) {
    Displayc("A hele, ve skøínce jsou nìjaké penízky, ty by se mohli hodit...");
    return;
  }
  if (udedy_skrinka_faze==0) {
    Displayc("Skøínka obsahuje hromadu osobních dìdových vìcí. Jeslti chceš najít nìco potøebného, musíš se podívat lépe.");
    udedy_skrinka_faze++;
    return;
  }
}

function skrinka_otevrena_Interact()
{
  cEgo.Walk(57, 150, eBlock, eWalkableAreas);
  if (udedy_skrinka_faze==0) {
    Displayc("Nejdøív se tam poøádnì podívej, je tam hromada krámù...");
    return;
  }
  
  if (udedy_skrinka_faze==1) {
    Displayc("Sebral jsi 20 zlatých!");
    penize = penize + 20;
    udedy_skrinka_faze++;
    return;
  }

  if (udedy_skrinka_faze>=2) {
    Displayc("Ve skøínce už není nic, co by sis mohl pøivlastnit!");
    return;
  }
  
}

function room_Leave()
{
  SetPochoden(false);
  aSnoring_right.Stop();
  aKrb_polinko.Stop();
}

function bigbluecup_Look()
{
  Displayc("Velký modrý hrnek.");
}


function hHotspot14_Look()
{
  Displayc("Na stole je dìdovo haraburdí, které používá pro svou ševcovskou práci.");
}


function hHotspot14_Interact()
{
  EndGame(1, "");
  //Displayc("Nic z toho, co je na stole pravdìpodobnì vùbec nebudeš potøebovat, proto to tu radìji nechej (a navíc je to moc na ránì, èmajznout to dìdovi pøímo ze stolu)");
}

function hHotspot13_UseInv()
{
  //vrat koste
  if (player.ActiveInventory==iKoste) {
    Displayc("Dobrá, vrátíme koštì tam, kam patøí.");
    cEgo.Walk(96, 121, eBlock);
    player.LoseInventory(iKoste);
    zobrazKoste = true;
    Wait(1);
    object[0].Visible=true;
    Wait(1);    
  }
  
}

function on_call (int value) {
  if (value == 0) {
    dedaSkrinkaKontrola();
  }
}